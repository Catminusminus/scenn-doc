<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Sequential ConstExpr Neural Network | SCENN Documentation</title>
    <meta name="description" content="Document for SCENN">
    
    
    <link rel="preload" href="/scenn-doc/assets/css/0.styles.36defa16.css" as="style"><link rel="preload" href="/scenn-doc/assets/js/app.818c9ca6.js" as="script"><link rel="preload" href="/scenn-doc/assets/js/2.5569164b.js" as="script"><link rel="preload" href="/scenn-doc/assets/js/5.f0204d63.js" as="script"><link rel="prefetch" href="/scenn-doc/assets/js/10.3d0738c0.js"><link rel="prefetch" href="/scenn-doc/assets/js/11.b2803caf.js"><link rel="prefetch" href="/scenn-doc/assets/js/12.a6e71964.js"><link rel="prefetch" href="/scenn-doc/assets/js/13.37140cfd.js"><link rel="prefetch" href="/scenn-doc/assets/js/3.51513787.js"><link rel="prefetch" href="/scenn-doc/assets/js/4.3ff2fe10.js"><link rel="prefetch" href="/scenn-doc/assets/js/6.7c924d91.js"><link rel="prefetch" href="/scenn-doc/assets/js/7.7df90228.js"><link rel="prefetch" href="/scenn-doc/assets/js/8.e1c15f9b.js"><link rel="prefetch" href="/scenn-doc/assets/js/9.8a9c217b.js">
    <link rel="stylesheet" href="/scenn-doc/assets/css/0.styles.36defa16.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container no-sidebar"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/scenn-doc/" class="home-link router-link-exact-active router-link-active"><!----> <span class="site-name">SCENN Documentation</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/scenn-doc/" class="nav-link router-link-exact-active router-link-active">Introduction</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Getting Started" class="dropdown-title"><span class="title">Getting Started</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/scenn-doc/getting-started/install.html" class="nav-link">Install</a></li><li class="dropdown-item"><!----> <a href="/scenn-doc/getting-started/examples.html" class="nav-link">Examples</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Features" class="dropdown-title"><span class="title">Features</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/scenn-doc/feature/model.html" class="nav-link">Model</a></li><li class="dropdown-item"><!----> <a href="/scenn-doc/feature/loss.html" class="nav-link">Loss Function</a></li><li class="dropdown-item"><!----> <a href="/scenn-doc/feature/activation.html" class="nav-link">Activation</a></li><li class="dropdown-item"><!----> <a href="/scenn-doc/feature/layer.html" class="nav-link">Layer</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Development Guide" class="dropdown-title"><span class="title">Development Guide</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/scenn-doc/dev/activation.html" class="nav-link">Add Your Own Activation Function</a></li></ul></div></div> <a href="https://github.com/Catminusminus/scenn" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/scenn-doc/" class="nav-link router-link-exact-active router-link-active">Introduction</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Getting Started" class="dropdown-title"><span class="title">Getting Started</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/scenn-doc/getting-started/install.html" class="nav-link">Install</a></li><li class="dropdown-item"><!----> <a href="/scenn-doc/getting-started/examples.html" class="nav-link">Examples</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Features" class="dropdown-title"><span class="title">Features</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/scenn-doc/feature/model.html" class="nav-link">Model</a></li><li class="dropdown-item"><!----> <a href="/scenn-doc/feature/loss.html" class="nav-link">Loss Function</a></li><li class="dropdown-item"><!----> <a href="/scenn-doc/feature/activation.html" class="nav-link">Activation</a></li><li class="dropdown-item"><!----> <a href="/scenn-doc/feature/layer.html" class="nav-link">Layer</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Development Guide" class="dropdown-title"><span class="title">Development Guide</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/scenn-doc/dev/activation.html" class="nav-link">Add Your Own Activation Function</a></li></ul></div></div> <a href="https://github.com/Catminusminus/scenn" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></nav>  <!----> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="sequential-constexpr-neural-network"><a href="#sequential-constexpr-neural-network" class="header-anchor">#</a> Sequential ConstExpr Neural Network</h1> <p>Proof of concept of sequential models of neural networks in compile time.</p> <p><strong>Alpha Stage</strong></p> <p><strong>This document is under development.</strong></p> <h2 id="what-is-this"><a href="#what-is-this" class="header-anchor">#</a> What is this?</h2> <p>You can build your own constexpr neural networks which run in compile time easily.</p> <p><strong>XOR Example:</strong></p> <div class="language-cpp extra-class"><pre class="language-cpp"><code><span class="token comment">// training and evaluating an model in compile time</span>
SCENN_CONSTEXPR <span class="token keyword">auto</span> <span class="token function">test</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">using</span> <span class="token keyword">namespace</span> scenn<span class="token punctuation">;</span>
  <span class="token keyword">double</span> X_arr<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">{</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">{</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">{</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">{</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
  <span class="token keyword">double</span> Y_arr<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">{</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">{</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">{</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">{</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
  <span class="token keyword">auto</span> dataset <span class="token operator">=</span> <span class="token function">Dataset</span><span class="token punctuation">(</span><span class="token function">make_matrix_from_array</span><span class="token punctuation">(</span>std<span class="token operator">::</span><span class="token function">move</span><span class="token punctuation">(</span>X_arr<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
                         <span class="token function">make_matrix_from_array</span><span class="token punctuation">(</span>std<span class="token operator">::</span><span class="token function">move</span><span class="token punctuation">(</span>Y_arr<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">auto</span> trained_model <span class="token operator">=</span>
      <span class="token function">SequentialNetwork</span><span class="token punctuation">(</span><span class="token function">BinaryCrossEntropy</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> DenseLayer<span class="token operator">&lt;</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token keyword">double</span><span class="token operator">&gt;</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
                        ActivationLayer<span class="token operator">&lt;</span><span class="token number">4</span><span class="token punctuation">,</span> <span class="token keyword">double</span><span class="token operator">&gt;</span><span class="token punctuation">(</span><span class="token function">Sigmoid</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
                        DenseLayer<span class="token operator">&lt;</span><span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token keyword">double</span><span class="token operator">&gt;</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
                        ActivationLayer<span class="token operator">&lt;</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token keyword">double</span><span class="token operator">&gt;</span><span class="token punctuation">(</span><span class="token function">Sigmoid</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
          <span class="token punctuation">.</span>train<span class="token operator">&lt;</span><span class="token number">2</span><span class="token operator">&gt;</span><span class="token punctuation">(</span>dataset<span class="token punctuation">,</span> <span class="token number">2000</span><span class="token punctuation">,</span> <span class="token number">0.1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">return</span> trained_model<span class="token punctuation">.</span><span class="token function">evaluate</span><span class="token punctuation">(</span>std<span class="token operator">::</span><span class="token function">move</span><span class="token punctuation">(</span>dataset<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  SCENN_CONSTEXPR <span class="token keyword">auto</span> evaluation <span class="token operator">=</span> <span class="token function">test</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  std<span class="token operator">::</span>cout <span class="token operator">&lt;&lt;</span> evaluation <span class="token operator">&lt;&lt;</span> std<span class="token operator">::</span>endl<span class="token punctuation">;</span> <span class="token comment">// 4</span>
<span class="token punctuation">}</span>

</code></pre></div><p>like the Python code with <a href="https://github.com/keras-team/keras" target="_blank" rel="noopener noreferrer">Keras<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p> <div class="language-python extra-class"><pre class="language-python"><code>X_train <span class="token operator">=</span> numpy<span class="token punctuation">.</span>array<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
Y_train <span class="token operator">=</span> numpy<span class="token punctuation">.</span>array<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
model <span class="token operator">=</span> Sequential<span class="token punctuation">(</span><span class="token punctuation">[</span>
  Dense<span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">,</span> input_dim<span class="token operator">=</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  Activation<span class="token punctuation">(</span><span class="token string">'sigmoid'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  Dense<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span> input_dim<span class="token operator">=</span><span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  Activation<span class="token punctuation">(</span><span class="token string">'sigmoid'</span><span class="token punctuation">)</span>
<span class="token punctuation">]</span><span class="token punctuation">)</span>
model<span class="token punctuation">.</span><span class="token builtin">compile</span><span class="token punctuation">(</span>loss<span class="token operator">=</span><span class="token string">'binary_crossentropy'</span><span class="token punctuation">,</span> optimizer<span class="token operator">=</span>SGD<span class="token punctuation">(</span><span class="token number">0.1</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
model<span class="token punctuation">.</span>fit<span class="token punctuation">(</span>X_train<span class="token punctuation">,</span> Y_train<span class="token punctuation">,</span> batch_size<span class="token operator">=</span><span class="token number">2</span><span class="token punctuation">,</span> epochs<span class="token operator">=</span><span class="token number">2000</span><span class="token punctuation">)</span>
<span class="token comment"># Omit the evaluation</span>
</code></pre></div><p><strong>MNIST EXAMPLE:</strong>
To avoid hitting the constexpr evaluation step limit, you need to patch <code>clang-patch.diff</code> to clang. In the below code, we use a subset of <a href="http://yann.lecun.com/exdb/mnist/" target="_blank" rel="noopener noreferrer">MNIST dataset<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>, with 100 train size, 10 test size and 3 classes. To generate the sub-dataset, run</p> <div class="language- extra-class"><pre class="language-text"><code>// See https://github.com/maxpumperla/deep_learning_and_the_game_of_go/blob/master/code/dlgo/nn/load_mnist.py
wget https://s3.amazonaws.com/img-datasets/mnist.npz -O mnist.npz
</code></pre></div><p>To generate the sub-dataset, use <code>tools/generate_mini_mnist.py</code>.</p> <div class="language-cpp extra-class"><pre class="language-cpp"><code><span class="token comment">// training and evaluating an model in compile time</span>
SCENN_CONSTEXPR <span class="token keyword">auto</span> <span class="token function">mini_mnist_test</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">using</span> <span class="token keyword">namespace</span> scenn<span class="token punctuation">;</span>
  <span class="token keyword">auto</span> <span class="token punctuation">[</span>train_data<span class="token punctuation">,</span> test_data<span class="token punctuation">]</span> <span class="token operator">=</span> load_mini_mnist_data<span class="token operator">&lt;</span><span class="token keyword">double</span><span class="token operator">&gt;</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">auto</span> evaluation <span class="token operator">=</span>
      <span class="token function">SequentialNetwork</span><span class="token punctuation">(</span><span class="token function">CrossEntropy</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> DenseLayer<span class="token operator">&lt;</span><span class="token number">784</span><span class="token punctuation">,</span> <span class="token number">196</span><span class="token punctuation">,</span> <span class="token keyword">double</span><span class="token operator">&gt;</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
                        ActivationLayer<span class="token operator">&lt;</span><span class="token number">196</span><span class="token punctuation">,</span> <span class="token keyword">double</span><span class="token operator">&gt;</span><span class="token punctuation">(</span><span class="token function">Sigmoid</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
                        DenseLayer<span class="token operator">&lt;</span><span class="token number">196</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token keyword">double</span><span class="token operator">&gt;</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
                        ActivationLayer<span class="token operator">&lt;</span><span class="token number">3</span><span class="token punctuation">,</span> <span class="token keyword">double</span><span class="token operator">&gt;</span><span class="token punctuation">(</span><span class="token function">Softmax</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
          <span class="token punctuation">.</span>train<span class="token operator">&lt;</span><span class="token number">100</span><span class="token operator">&gt;</span><span class="token punctuation">(</span>std<span class="token operator">::</span><span class="token function">move</span><span class="token punctuation">(</span>train_data<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">20</span><span class="token punctuation">,</span> <span class="token number">0.1</span><span class="token punctuation">)</span>
          <span class="token punctuation">.</span><span class="token function">evaluate</span><span class="token punctuation">(</span>std<span class="token operator">::</span><span class="token function">move</span><span class="token punctuation">(</span>test_data<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">return</span> evaluation<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  SCENN_CONSTEXPR <span class="token keyword">auto</span> evaluation <span class="token operator">=</span> <span class="token function">mini_mnist_test</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  std<span class="token operator">::</span>cout <span class="token operator">&lt;&lt;</span> evaluation <span class="token operator">&lt;&lt;</span> std<span class="token operator">::</span>endl<span class="token punctuation">;</span> <span class="token comment">// we see 8</span>
<span class="token punctuation">}</span>
</code></pre></div><h2 id="examples"><a href="#examples" class="header-anchor">#</a> Examples</h2> <p>The example codes in the <code>examples</code> directory. The followings are in the directory.</p> <ul><li>XOR</li> <li>MNIST</li> <li>Malware Detection
<ul><li>You need the <a href="https://github.com/endgameinc/ember" target="_blank" rel="noopener noreferrer">ember<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> dataset to run this example. The citation is `H. Anderson and P. Roth, &quot;EMBER: An Open Dataset for Training Static PE Malware Machine Learning Models”, in ArXiv e-prints. Apr. 2018.</li></ul></li></ul> <h2 id="how-to-use"><a href="#how-to-use" class="header-anchor">#</a> How to use?</h2> <h3 id="requirements"><a href="#requirements" class="header-anchor">#</a> Requirements</h3> <ul><li>Clang 6+</li> <li><a href="https://github.com/bolero-MURAKAMI/Sprout" target="_blank" rel="noopener noreferrer">Sprout C++ Libraries<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li> <li>Python 3.7 (Optional)</li></ul> <h3 id="install"><a href="#install" class="header-anchor">#</a> Install</h3> <p>This library is a header-only library.</p> <p>Include <code>&lt;scenn/scenn.hpp&gt;</code> and you can use all things provided by scenn except for <code>load_mini_mnist_data</code>. To use <code>load_mini_mnist_data</code> function, you need to prepare the mnist sub-dataset by <code>tools/generate_mini_mnist.py</code> and include <code>&lt;scenn/load.hpp&gt;</code>.</p> <h3 id="quick-start"><a href="#quick-start" class="header-anchor">#</a> Quick Start</h3> <div class="language- extra-class"><pre class="language-text"><code>git clone https://github.com/bolero-MURAKAMI/Sprout.git
git clone https://github.com/Catminusminus/scenn.git

export SPROUT_PATH=./Sprout/
export SCENN_PATH=./scenn/

// Run the xor example
clang++ ./scenn/examples/xor.cpp -Wall -Wextra -I$SPROUT_PATH -I$SCENN_PATH -std=gnu++2a -fconstexpr-steps=-1

// After a few hours

./a.out // You will see 4.
</code></pre></div><h3 id="features"><a href="#features" class="header-anchor">#</a> Features</h3> <h4 id="model"><a href="#model" class="header-anchor">#</a> Model</h4> <ul><li><code>scenn::SequentialNetwork</code> <ul><li><code>SequentialNetwork(loss_function, layers...)</code></li> <li><code>train&lt;MiniBatchSize&gt;(training_data, epochs, learning_rate)</code></li> <li><code>single_forwatd(test_data)</code></li> <li><code>evaluate(test_data)</code></li></ul></li></ul> <h4 id="layers"><a href="#layers" class="header-anchor">#</a> Layers</h4> <ul><li><code>scenn::DenseLayer&lt;input_dim, output_dim, num_type&gt;(seed)</code></li> <li><code>scenn::ActivationLayer&lt;dim, num_type&gt;(activation_function)</code></li></ul> <h4 id="activation"><a href="#activation" class="header-anchor">#</a> Activation</h4> <ul><li><code>scenn::Sigmoid()</code></li> <li><code>scenn::HardSigmoid()</code></li> <li><code>scenn::Softmax()</code></li> <li><code>scenn::ReLU()</code></li> <li><code>scenn::ELU(alpha)</code></li> <li><code>scenn::SeLU&lt;num_type&gt;()</code></li> <li><code>scenn::LeakyReLU(alpha)</code></li> <li><code>scenn::ThresholdedReLU(theta)</code></li></ul> <h4 id="loss-function"><a href="#loss-function" class="header-anchor">#</a> Loss Function</h4> <ul><li><code>scenn::MSE()</code></li> <li><code>scenn::MSLE()</code></li> <li><code>scenn::BinaryCrossEntropy()</code></li> <li><code>scenn::CrossEntropy()</code></li> <li><code>scenn::Hinge()</code></li></ul> <h2 id="limitaion"><a href="#limitaion" class="header-anchor">#</a> Limitaion</h2> <p>So many limitaions exist...</p> <ul><li>Only &quot;1D data&quot; (more precisely, not 1D vectors but rank-1 tensors) can be used.</li> <li>Hittig the constexpr evaluation step limit easily.
<ul><li>Use the patch <code>clang-patch.diff</code> for newer clang based on https://github.com/ushitora-anqou/constexpr-nn/blob/master/clang.diff.</li></ul></li> <li>You can run training and evaluating only in compile time, because runtime training and evaluating hit the stack size limit. We are planning to use the heap memory allocation in runtime (we will use std::vector in both cases in C++20).</li></ul> <h2 id="how-it-works"><a href="#how-it-works" class="header-anchor">#</a> How it works?</h2> <p>Thanks to <a href="https://github.com/bolero-MURAKAMI/Sprout" target="_blank" rel="noopener noreferrer">Sprout C++ Libraries<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p> <h2 id="important-disclosure"><a href="#important-disclosure" class="header-anchor">#</a> Important Disclosure</h2> <p>This project is inspired by a neural network in <a href="https://github.com/maxpumperla/deep_learning_and_the_game_of_go/tree/master/code/dlgo/nn" target="_blank" rel="noopener noreferrer">dlgo<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>.</p> <p>scenn/matrix/matrix.hpp is based on https://github.com/ushitora-anqou/constexpr-nn/blob/master/main.cpp.
The license file is LICENSE.constexpr-nn.</p> <h2 id="author"><a href="#author" class="header-anchor">#</a> Author</h2> <p>Catminusminus</p> <h2 id="license"><a href="#license" class="header-anchor">#</a> LICENSE</h2> <p>MIT</p></div> <footer class="page-edit"><div class="edit-link"><a href="https://github.com/Catminusminus/scenn-doc/edit/master/docs/README.md" target="_blank" rel="noopener noreferrer">Any contributions are greatly welcomed. Thank you.</a> <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></div> <!----></footer> <!----> </main></div><div class="global-ui"></div></div>
    <script src="/scenn-doc/assets/js/app.818c9ca6.js" defer></script><script src="/scenn-doc/assets/js/2.5569164b.js" defer></script><script src="/scenn-doc/assets/js/5.f0204d63.js" defer></script>
  </body>
</html>
